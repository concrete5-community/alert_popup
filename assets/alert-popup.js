(function(){"use strict";var a;if(!((a=window.ccmAlertPopup)===null||a===void 0)&&a.show){console.warn("ccmAlertPopup is already defined");return}const o=[];function d(e){return typeof e=="object"&&e!==null&&typeof e.jquery=="string"&&typeof e.on=="function"}function c(e){const s=e.match(/^(\d+(\.(\d+))?)\s*(ms|s)$/);if(!s)return null;const t=parseFloat(s[1]),n=s[4];return n==="ms"?t:n==="s"?t*1e3:null}function h(e){let s=null;if(e instanceof HTMLElement)s=e;else if(typeof e=="string"){if(e=e.replace(/^\s*#|\s+/,""),e==="")throw new Error("Empty selector string provided");const t=document.querySelectorAll(`#${e}`);switch(t.length){case 0:throw new Error(`No elements found for selector ${e}`);case 1:s=t[0];break;default:throw new Error(`Multiple elements found for selector ${e}`)}}else if(d(e))switch(e.length){case 0:throw new Error("The jQuery object doesn't contain any element");case 1:s=e[0];break;default:throw new Error("The jQuery object contains more than one elements")}else throw new Error("Invalid query type "+typeof e);if(s.tagName!=="DIALOG")throw new Error("Element is not a dialog, but a "+s.tagName);return s}function p(){const e=document.createElement("div");return e.className="ccm-alert-popup-close",e.innerText="\u{1F5D9}",e}function f(e,s){var t;const n=e.id,i=[],r=[];if(!((t=e.dataset)===null||t===void 0)&&t.backdropColor&&r.push(`background-color: ${e.dataset.backdropColor};`),s){const E=window.getComputedStyle(e),u=c(E.transitionDuration);u!==null&&r.push(`transition-duration: ${u}ms;`)}if(r.length>0&&i.push(`dialog#${n}::backdrop { ${r.join(" ")} }`),i.length===0)return null;const l=document.createElement("style");return l.type="text/css",l.innerHTML=i.join(`
`),(document.head||document.body).appendChild(l),l}class m{constructor(s,t){this.closed=!1,this.el=s,this.options=t,this.animated=!1,this.el.classList.forEach(n=>{n.startsWith("ccm-alert-popup-anim-")&&(this.animated=!0)}),this.clickListener=n=>{n.target===this.el&&this.close()},this.closeListener=n=>{this.close()},this.cancelListener=n=>{n.preventDefault(),this.close()},this.closeButton=p(),this.el.prepend(this.closeButton),this.closeButton.addEventListener("click",n=>{n.stopPropagation(),n.preventDefault(),this.close()}),this.el.addEventListener("click",this.clickListener),this.el.addEventListener("close",this.closeListener),this.el.addEventListener("cancel",this.cancelListener),o.push(this),this.styleElement=f(this.el,this.animated),this.el.showModal(),this.animated?window.requestAnimationFrame(()=>{this.el.classList.add("ccm-alert-popup-open");const n=window.getComputedStyle(this.el),i=c(n.transitionDuration);i===null?console.warn("Invalid transition duration"):(this.revertTransitionProperty=n.transitionProperty,setTimeout(()=>this.el.style.transitionProperty="none",i+100))}):this.el.classList.add("ccm-alert-popup-open")}close(){if(this.closed)return;this.closed=!0,this.revertTransitionProperty!==void 0&&(this.el.style.transitionProperty=this.revertTransitionProperty),this.el.removeEventListener("click",this.clickListener),this.el.removeEventListener("close",this.closeListener);const s=()=>{var t,n;this.el.removeEventListener("cancel",this.cancelListener),this.el.close(),this.el.removeChild(this.closeButton);const i=o.indexOf(this);i>=0&&o.splice(i,1),this.styleElement&&this.styleElement.parentElement.removeChild(this.styleElement),(n=(t=this.options)===null||t===void 0?void 0:t.closed)===null||n===void 0||n.call(t)};this.el.classList.remove("ccm-alert-popup-open"),this.animated?this.el.addEventListener("transitionend",()=>s(),{once:!0}):s()}}function w(e,s){try{const t=h(e);if(o.some(n=>n.el===t))throw new Error("Popup is already open");new m(t,s)}catch(t){console.warn(t?.message||t||"Unknown error");return}}function v(){const e=o.pop();return e?(e.close(),!0):(console.warn("No open popups to hide"),!1)}Object.defineProperty(window,"ccmAlertPopup",{writable:!1,value:Object.defineProperties({},{show:{value:w,writable:!1,enumerable:!0,configurable:!1},hide:{value:v,writable:!1,enumerable:!0,configurable:!1},isOpen:{get:()=>o.length>0,enumerable:!0,configurable:!1}}),enumerable:!0,configurable:!1})})();
