(function(){"use strict";var r;if(!((r=window.ccmAlertPopup)===null||r===void 0)&&r.show){console.warn("ccmAlertPopup is already defined");return}const i=[];function l(e){return typeof e=="object"&&e!==null&&typeof e.jquery=="string"&&typeof e.on=="function"}function c(e){const n=e.match(/^(\d+(\.(\d+))?)\s*(ms|s)$/);if(!n)return null;const s=parseFloat(n[1]),t=n[4];return t==="ms"?s:t==="s"?s*1e3:null}function a(e){let n=null;if(e instanceof HTMLElement)n=e;else if(typeof e=="string"){if(e=e.replace(/^\s*#|\s+/,""),e==="")throw new Error("Empty selector string provided");const s=document.querySelectorAll(`#${e}`);switch(s.length){case 0:throw new Error(`No elements found for selector ${e}`);case 1:n=s[0];break;default:throw new Error(`Multiple elements found for selector ${e}`)}}else if(l(e))switch(e.length){case 0:throw new Error("The jQuery object doesn't contain any element");case 1:n=e[0];break;default:throw new Error("The jQuery object contains more than one elements")}else throw new Error("Invalid query type "+typeof e);if(n.tagName!=="DIALOG")throw new Error("Element is not a dialog, but a "+n.tagName);return n}function u(){const e=document.createElement("div");return e.className="ccm-alert-popup-close",e.innerText="\u{1F5D9}",e}class h{constructor(n,s){this.closed=!1,this.el=n,this.options=s,this.animated=!1,this.el.classList.forEach(t=>{t.startsWith("ccm-alert-popup-anim-")&&(this.animated=!0)}),this.clickListener=t=>{t.target===this.el&&this.close()},this.closeListener=t=>{this.close()},this.cancelListener=t=>{t.preventDefault(),this.close()},this.closeButton=u(),this.el.prepend(this.closeButton),this.closeButton.addEventListener("click",t=>{t.stopPropagation(),t.preventDefault(),this.close()}),this.el.addEventListener("click",this.clickListener),this.el.addEventListener("close",this.closeListener),this.el.addEventListener("cancel",this.cancelListener),i.push(this),this.el.showModal(),this.animated?window.requestAnimationFrame(()=>{this.el.classList.add("ccm-alert-popup-open");const t=window.getComputedStyle(this.el),o=c(t.transitionDuration);o===null?console.warn("Invalid transition duration"):(this.revertTransitionProperty=t.transitionProperty,setTimeout(()=>this.el.style.transitionProperty="none",o+100))}):this.el.classList.add("ccm-alert-popup-open")}close(){if(this.closed)return;this.closed=!0,this.revertTransitionProperty!==void 0&&(this.el.style.transitionProperty=this.revertTransitionProperty),this.el.removeEventListener("click",this.clickListener),this.el.removeEventListener("close",this.closeListener);const n=()=>{var s,t;this.el.removeEventListener("cancel",this.cancelListener),this.el.close(),this.el.removeChild(this.closeButton);const o=i.indexOf(this);o>=0&&i.splice(o,1),(t=(s=this.options)===null||s===void 0?void 0:s.closed)===null||t===void 0||t.call(s)};this.el.classList.remove("ccm-alert-popup-open"),this.animated?this.el.addEventListener("transitionend",()=>n(),{once:!0}):n()}}function p(e,n){try{const s=a(e);if(i.some(t=>t.el===s))throw new Error("Popup is already open");new h(s,n)}catch(s){console.warn(s?.message||s||"Unknown error");return}}function d(){const e=i.pop();return e?(e.close(),!0):(console.warn("No open popups to hide"),!1)}Object.defineProperty(window,"ccmAlertPopup",{writable:!1,value:Object.defineProperties({},{show:{value:p,writable:!1,enumerable:!0,configurable:!1},hide:{value:d,writable:!1,enumerable:!0,configurable:!1},isOpen:{get:()=>i.length>0,enumerable:!0,configurable:!1}}),enumerable:!0,configurable:!1})})();
